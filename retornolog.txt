#Código para linguagem R
name<-readline(prompt='Digite o endereço do arquivo texto:')

#É necessário digitar o endereço do arquivo texto gerado pelo código python nesta linha.

tabela<-read.table(name,sep=',')

log.return<-function(v,d,x=tabela)
{
k<-switch(v,
'date'=x$V1,
'close'=x$V2,
'high'=x$V3,
'low'=x$V4,
'open'=x$V5,
'volume'=x$V6,
'erro')
o<-c()
for (i in (d:length(k)))

o<-append(o,log(k[i]/k[i-d]))

return (o)
}

#Abaixo está um exemplo de como chamar a função: fornecer qual variável deseja estudar e fornecer o tamanho da janela.
#No exemplo, a variável escolhida foi Close e janela d=50. 
q<-log.return(2,50)
x11()
plot(q,type='l',main='retorno log',col='blue')
x11()
plot(density(q),main='density plot, retorno log',col='blue')
